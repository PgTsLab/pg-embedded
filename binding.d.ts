/* auto-generated by NAPI-RS */
/* eslint-disable */
/** Connection information structure */
export declare class ConnectionInfo {
  /** Host address */
  host: string
  /** Port number */
  port: number
  /** Username */
  username: string
  /** Password */
  password: string
  /** Database name */
  databaseName: string
  /** Connection string */
  connectionString: string
  /** Generate a safe connection string without password (for logging) */
  safeConnectionString(): string
  /** Generate JDBC format connection string */
  jdbcUrl(): string
}

/** A tool for checking the connection status of a PostgreSQL server. */
export declare class PgIsReadyTool {
  /** Creates a new `PgIsReadyTool` instance. */
  constructor(options: PgIsReadyOptions)
  /** Performs a quick check to see if the server is running. */
  check(): Promise<boolean>
  /** Executes `pg_isready` and returns the detailed result. */
  execute(): Promise<ToolResult>
}

/**
 * PostgreSQL embedded instance manager
 *
 * This class provides a high-level interface for managing embedded PostgreSQL instances.
 * It supports both synchronous and asynchronous operations, automatic resource management,
 * and connection caching for optimal performance.
 *
 * @example
 * ```typescript
 * import { PostgresInstance } from 'pg-embedded';
 *
 * const instance = new PostgresInstance({
 *   port: 5432,
 *   username: 'postgres',
 *   password: 'password'
 * });
 *
 * await instance.start();
 * await instance.createDatabase('mydb');
 * await instance.stop();
 * ```
 */
export declare class PostgresInstance {
  /**
   * Creates a new PostgreSQL instance with the specified settings
   *
   * @param settings - Configuration settings for the PostgreSQL instance
   * @returns A new PostgresInstance
   *
   * @example
   * ```typescript
   * const instance = new PostgresInstance({
   *   port: 5432,
   *   username: 'postgres',
   *   password: 'password',
   *   persistent: false
   * });
   * ```
   */
  constructor(settings?: PostgresSettings | undefined | null)
  /**
   * Gets the unique instance ID
   *
   * @returns The unique identifier for this PostgreSQL instance
   */
  get instanceId(): string
  /**
   * Gets the configuration hash for this instance
   *
   * This hash is used internally for caching and can be useful for debugging.
   *
   * @returns A string hash of the instance configuration
   */
  getConfigHash(): string
  /** Gets the directory where the PostgreSQL binaries are located. */
  get programDir(): string
  /**
   * Gets the current state of the PostgreSQL instance
   *
   * @returns The current instance state (Stopped, Starting, Running, or Stopping)
   */
  get state(): InstanceState
  /**
   * Gets the connection information for the PostgreSQL instance
   *
   * This method returns cached connection information when available for better performance.
   * The cache is automatically invalidated after 5 minutes.
   *
   * @returns Connection information including host, port, username, and connection string
   * @throws Error if the instance is not running
   */
  get connectionInfo(): ConnectionInfo
  /**
   * Checks if the PostgreSQL instance is healthy and running
   *
   * @returns true if the instance is running and healthy, false otherwise
   */
  isHealthy(): boolean
  /**
   * # Safety
   * Sets up the PostgreSQL instance asynchronously
   *
   * This method initializes the PostgreSQL instance but does not start it.
   * It's automatically called by start() if needed.
   *
   * @returns Promise that resolves when setup is complete
   * @throws Error if setup fails
   */
  setup(): Promise<void>
  /**
   * # Safety
   * Starts the PostgreSQL instance asynchronously
   *
   * This method starts the PostgreSQL server and makes it ready to accept connections.
   * It includes automatic setup if the instance hasn't been set up yet.
   *
   * @returns Promise that resolves when the instance is started and ready
   * @throws Error if the instance is already running or if startup fails
   *
   * @example
   * ```typescript
   * await instance.start();
   * console.log('PostgreSQL is ready!');
   * ```
   */
  start(): Promise<void>
  /**
   * # Safety
   * Stops the PostgreSQL instance asynchronously
   *
   * This method gracefully shuts down the PostgreSQL server.
   *
   * @returns Promise that resolves when the instance is stopped
   * @throws Error if the instance is already stopped or if stopping fails
   *
   * @example
   * ```typescript
   * await instance.stop();
   * console.log('PostgreSQL stopped');
   * ```
   */
  stop(): Promise<void>
  /**
   * # Safety
   * Creates a new database asynchronously
   *
   * @param name - The name of the database to create
   * @returns Promise that resolves when the database is created
   * @throws Error if the instance is not running or if database creation fails
   *
   * @example
   * ```typescript
   * await instance.createDatabase('myapp');
   * ```
   */
  createDatabase(name: string): Promise<void>
  /**
   * # Safety
   * Drops (deletes) a database asynchronously
   *
   * @param name - The name of the database to drop
   * @returns Promise that resolves when the database is dropped
   * @throws Error if the instance is not running or if database deletion fails
   *
   * @example
   * ```typescript
   * await instance.dropDatabase('myapp');
   * ```
   */
  dropDatabase(name: string): Promise<void>
  /**
   * Checks if a database exists asynchronously
   *
   * @param name - The name of the database to check
   * @returns Promise that resolves to true if the database exists, false otherwise
   * @throws Error if the instance is not running or if the check fails
   *
   * @example
   * ```typescript
   * const exists = await instance.databaseExists('myapp');
   * if (exists) {
   *   console.log('Database exists');
   * }
   * ```
   */
  databaseExists(name: string): Promise<boolean>
  /**
   * # Safety
   * Starts the PostgreSQL instance asynchronously with a timeout
   *
   * @param timeout_seconds - Maximum time to wait for startup in seconds
   * @returns Promise that resolves when the instance is started and ready
   * @throws Error if the instance is already running, if startup fails, or if timeout is exceeded
   *
   * @example
   * ```typescript
   * await instance.startWithTimeout(30); // 30 second timeout
   * ```
   */
  startWithTimeout(timeoutSeconds: number): Promise<void>
  /**
   * # Safety
   * Stops the PostgreSQL instance asynchronously with a timeout
   *
   * @param timeout_seconds - Maximum time to wait for shutdown in seconds
   * @returns Promise that resolves when the instance is stopped
   * @throws Error if the instance is already stopped, if stopping fails, or if timeout is exceeded
   *
   * @example
   * ```typescript
   * await instance.stopWithTimeout(10); // 10 second timeout
   * ```
   */
  stopWithTimeout(timeoutSeconds: number): Promise<void>
  /**
   * Gets the startup time of the PostgreSQL instance in seconds
   *
   * This method returns the time it took for the last successful start operation.
   *
   * @returns The startup time in seconds, or null if the instance hasn't been started yet
   *
   * @example
   * ```typescript
   * await instance.start();
   * const startupTime = instance.getStartupTime();
   * console.log(`Started in ${startupTime} seconds`);
   * ```
   */
  getStartupTime(): number | null
  /**
   * Clears the connection information cache
   *
   * This forces the next call to connectionInfo to regenerate the connection information.
   *
   * @returns void
   */
  clearConnectionCache(): void
  /**
   * Checks if the connection information cache is valid
   *
   * The cache is considered valid if it exists and is less than 5 minutes old.
   *
   * @returns true if the cache is valid, false otherwise
   */
  isConnectionCacheValid(): boolean
  /**
   * Gets the PostgreSQL version used by this instance
   *
   * @returns PostgreSQL version string (e.g., "15.4")
   *
   * @example
   * ```typescript
   * const version = instance.getPostgreSQLVersion();
   * console.log(`Using PostgreSQL ${version}`);
   * ```
   */
  getPostgreSqlVersion(): string
  /**
   * # Safety
   * Manually cleans up all resources associated with this instance
   *
   * This method stops the PostgreSQL instance (if running) and cleans up all resources.
   * It's automatically called when the instance is dropped, but can be called manually
   * for immediate cleanup.
   *
   * @returns void
   *
   * @example
   * ```typescript
   * await instance.cleanup();
   * console.log('Resources cleaned up');
   * ```
   */
  cleanup(): Promise<void>
}

/** A tool for executing SQL commands and scripts using the `psql` interactive terminal. */
export declare class PsqlTool {
  /** Creates a new instance of the `PsqlTool`. */
  constructor(options: PsqlOptions)
  /**
   * Executes a given SQL command string.
   *
   * This method allows reusing a `PsqlTool` instance with the same connection settings
   * to run multiple different commands.
   *
   * @param command_str - The SQL command string to execute.
   * @returns A promise that resolves to a `ToolResult` object.
   * @throws An error if the `psql` command fails to execute.
   *
   * @example
   * ```typescript
   * const result = await psql.executeCommand('SELECT version();');
   * console.log(result.stdout);
   * ```
   */
  executeCommand(commandStr: string): Promise<ToolResult>
  /**
   * Executes SQL commands from a given file.
   *
   * This method allows reusing a `PsqlTool` instance to run multiple different SQL script files.
   *
   * @param file_path - The path to the file containing SQL commands.
   * @returns A promise that resolves to a `ToolResult` object.
   * @throws An error if the `psql` command fails to execute.
   *
   * @example
   * ```typescript
   * const result = await psql.executeFile('/path/to/my/script.sql');
   * console.log(result.stdout);
   * ```
   */
  executeFile(filePath: string): Promise<ToolResult>
}

/** Build information */
export interface BuildInfo {
  /** Target platform (e.g., "x86_64-apple-darwin") */
  target: string
  /** Build profile (debug or release) */
  profile: string
  /** Rust compiler version used for build */
  rustcVersion: string
  /** Build timestamp */
  buildTimestamp: string
}

/** Configuration for connecting to a PostgreSQL server. */
export interface ConnectionConfig {
  /** The host of the PostgreSQL server. */
  host?: string
  /** The port of the PostgreSQL server. */
  port?: number
  /** The username to connect with. */
  username?: string
  /** The password to connect with. */
  password?: string
  /** The database to connect to. */
  database?: string
}

/**
 * Gets the package version of pg-embedded
 *
 * @returns Package version string (e.g., "1.0.0")
 *
 * @example
 * ```typescript
 * import { getPackageVersion } from 'pg-embedded';
 *
 * const version = getPackageVersion();
 * console.log(`pg-embedded version: ${version}`);
 * ```
 */
export declare function getPackageVersion(): string

/**
 * Gets the version of the embedded PostgreSQL binary
 *
 * @returns PostgreSQL version string (e.g., "15.4")
 *
 * @example
 * ```typescript
 * import { getPostgreSQLVersion } from 'pg-embedded';
 *
 * const pgVersion = getPostgreSQLVersion();
 * console.log(`Using PostgreSQL ${pgVersion}`);
 * ```
 */
export declare function getPostgreSqlVersion(): string

/**
 * Gets comprehensive version information about pg-embedded and PostgreSQL
 *
 * This function returns detailed version information including:
 * - pg-embedded package version
 * - Embedded PostgreSQL version
 * - Build information
 *
 * @returns Version information object
 *
 * @example
 * ```typescript
 * import { getVersionInfo } from 'pg-embedded';
 *
 * const versionInfo = getVersionInfo();
 * console.log(`Package version: ${versionInfo.packageVersion}`);
 * console.log(`PostgreSQL version: ${versionInfo.postgresqlVersion}`);
 * console.log(`Built for: ${versionInfo.buildInfo.target}`);
 * ```
 */
export declare function getVersionInfo(): VersionInfo

/** Initialize logger */
export declare function initLogger(level?: LogLevel | undefined | null): void

/** PostgreSQL instance state enumeration */
export declare const enum InstanceState {
  /** Stopped */
  Stopped = 0,
  /** Starting */
  Starting = 1,
  /** Running */
  Running = 2,
  /** Stopping */
  Stopping = 3
}

/** Log debug message */
export declare function logDebug(message: string): void

/** Log error message */
export declare function logError(message: string): void

/** Log info message */
export declare function logInfo(message: string): void

/** Log level enumeration */
export declare const enum LogLevel {
  /** Error level */
  Error = 0,
  /** Warning level */
  Warn = 1,
  /** Information level */
  Info = 2,
  /** Debug level */
  Debug = 3,
  /** Trace level */
  Trace = 4
}

/** Log trace message */
export declare function logTrace(message: string): void

/** Log warning message */
export declare function logWarn(message: string): void

export type PgEmbedError =
  | { type: 'SetupError', field0: string }
  | { type: 'StartError', field0: string }
  | { type: 'StopError', field0: string }
  | { type: 'DatabaseError', field0: string }
  | { type: 'ConfigurationError', field0: string }
  | { type: 'ConnectionError', field0: string }
  | { type: 'TimeoutError', field0: string }
  | { type: 'ToolError', field0: string }
  | { type: 'InternalError', field0: string }

/** Options for configuring the `pg_isready` tool. */
export interface PgIsReadyOptions {
  /** Connection settings for the PostgreSQL server. */
  connection?: ConnectionConfig
  /** The number of seconds to wait for a connection. */
  timeout?: number
  /** If `true`, suppresses status messages. */
  silent?: boolean
  /** The specific database name to check. */
  dbname?: string
  /** The directory where the `pg_isready` executable is located. */
  programDir?: string
}

/** PostgreSQL error type enumeration */
export declare const enum PostgresError {
  /** Setup error */
  SetupError = 0,
  /** Start error */
  StartError = 1,
  /** Stop error */
  StopError = 2,
  /** Database operation error */
  DatabaseError = 3,
  /** Configuration error */
  ConfigurationError = 4,
  /** Connection error */
  ConnectionError = 5,
  /** Timeout error */
  TimeoutError = 6,
  /** Tool error */
  ToolError = 7
}

/** PostgreSQL error information structure */
export interface PostgresErrorInfo {
  /** Error type */
  errorType: PostgresError
  /** Error message */
  message: string
  /** Error details */
  details?: string
}

/**
 * PostgreSQL configuration settings
 *
 * This object defines all the configuration options for a PostgreSQL embedded instance.
 * All fields are optional and will use sensible defaults if not provided.
 *
 * @example
 * ```typescript
 * const settings: PostgresSettings = {
 *   port: 5432,
 *   username: 'postgres',
 *   password: 'mypassword',
 *   persistent: false
 * };
 * ```
 */
export interface PostgresSettings {
  /** PostgreSQL version (e.g., "15.0", ">=14.0")  */
  version?: string
  /** Host address for database connection (default: "localhost")  */
  host?: string
  /** Port number (0-65535, default: 5432, 0 for random)  */
  port?: number
  /** Username for database connection (default: "postgres")  */
  username?: string
  /** Password for database connection (default: "postgres")  */
  password?: string
  /** Default database name (default: "postgres")  */
  databaseName?: string
  /** Custom data directory path  */
  dataDir?: string
  /** Custom installation directory path  */
  installationDir?: string
  /** Timeout in seconds for database operations (default: 30)  */
  timeout?: number
  /** Setup timeout in seconds for PostgreSQL initialization (default: 300 on Windows, 30 on other platforms)  */
  setupTimeout?: number
  /** Whether to persist data between runs (default: false)  */
  persistent?: boolean
}

/**
 * Options for configuring the `psql` tool, primarily for connection settings.
 *
 * @example
 * ```typescript
 * const options = {
 *   connection: {
 *     host: 'localhost',
 *     port: 5432,
 *     user: 'postgres',
 *     database: 'testdb',
 *   },
 *   variables: {
 *     'MY_VAR': 'some_value',
 *   },
 *   flags: ['--csv', '--single-transaction', '--tuples-only'],
 * };
 * ```
 */
export interface PsqlOptions {
  /** Connection settings for the PostgreSQL server. */
  connection?: ConnectionConfig
  /** Generic tool options like silent mode. */
  tool?: ToolOptions
  /** Variables to set for the psql session, equivalent to `psql -v NAME=VALUE`. */
  variables?: Record<string, string>
  /**
   * A list of boolean flags to pass to `psql`.
   * For example, `['--csv', '--tuples-only']`.
   */
  flags?: Array<string>
  /** The directory where the `pg_isready` executable is located. */
  programDir?: string
}

/** Generic options for a tool execution. */
export interface ToolOptions {
  /** Connection settings for the tool. */
  connection?: ConnectionConfig
  /** Timeout for the tool execution in seconds. */
  timeout?: number
  /** If true, suppresses tool output. */
  silent?: boolean
}

/** The result of a tool execution. */
export interface ToolResult {
  /** The exit code of the tool. */
  exitCode: number
  /** The standard output of the tool. */
  stdout: string
  /** The standard error of the tool. */
  stderr: string
}

/** Version information for the pg-embedded package and embedded PostgreSQL */
export interface VersionInfo {
  /** The version of the pg-embedded npm package */
  packageVersion: string
  /** The version of the embedded PostgreSQL binary */
  postgresqlVersion: string
  /** The version of the postgresql_embedded Rust crate */
  postgresqlEmbeddedVersion: string
  /** Build information */
  buildInfo: BuildInfo
}
